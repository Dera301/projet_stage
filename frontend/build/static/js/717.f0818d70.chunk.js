"use strict";(self.webpackChunkcolocation_antananarivo=self.webpackChunkcolocation_antananarivo||[]).push([[717],{1602:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const n=a.forwardRef(i)},2556:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z"}))}const n=a.forwardRef(i)},4111:(e,t,s)=>{s.d(t,{A:()=>n});s(5043);var r=s(2556),a=s(7591),l=s(5475),i=s(579);const n=e=>{let{isOpen:t,onClose:s,showBackButton:n=!0,backButtonText:o="Retour",onBackClick:c}=e;return t?(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[(0,i.jsx)("button",{onClick:()=>{s()},className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:(0,i.jsx)(a.A,{className:"h-6 w-6"})}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4",children:(0,i.jsx)(r.A,{className:"h-8 w-8 text-yellow-600"})}),(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"V\xe9rification Requise"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous devez v\xe9rifier votre CIN avant de pouvoir acc\xe9der \xe0 cette fonctionnalit\xe9."}),(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsx)(l.N_,{to:"/cin-verification",onClick:s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"V\xe9rifier mon CIN"}),n&&(0,i.jsx)("button",{type:"button",onClick:()=>{c&&c(),s()},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:o})]})]})]})}):null}},4717:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var r=s(9379),a=s(5043),l=s(3216),i=s(9741),n=s(4111),o=s(129),c=s(9349),d=s(7012),m=s(7449),u=s(7459),x=s(8662),h=s(7591),p=s(1602),g=s(2339),b=s(3986),f={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const y=["color","size","strokeWidth","absoluteStrokeWidth","children"];const v=((e,t)=>{const s=(0,a.forwardRef)((s,l)=>{let{color:i="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:c,children:d}=s,m=(0,b.A)(s,y);return(0,a.createElement)("svg",(0,r.A)((0,r.A)({ref:l},f),{},{width:n,height:n,stroke:i,strokeWidth:c?24*Number(o)/Number(n):o,className:"lucide lucide-".concat((u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()))},m),[...t.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...(Array.isArray(d)?d:[d])||[]]);var u});return s.displayName="".concat(e),s})("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);var j=s(579);const N=async e=>{const t=e.map(e=>(async e=>{const t=new FormData;t.append("image",e);try{var s,r;const e=await(0,c.yX)("/api/upload/image",t);if(!e.success)throw new Error(e.message||"Erreur lors de l'upload");return(null===(s=e.data)||void 0===s?void 0:s.url)||(null===(r=e.data)||void 0===r?void 0:r.path)||""}catch(a){throw console.error("\u274c Erreur upload:",a),new Error(a.message||"Impossible d'uploader l'image")}})(e));return Promise.all(t)},w=()=>{const e=(0,l.Zp)(),{createProperty:t,loading:s}=(0,o.N)(),{user:c}=(0,i.A)(),[b,f]=(0,a.useState)({title:"",description:"",address:"",district:"",price:0,deposit:0,availableRooms:1,totalRooms:1,propertyType:"apartment",amenities:[],images:[]}),[y,w]=(0,a.useState)([]),[A,k]=(0,a.useState)(null),[C,E]=(0,a.useState)(!1),[L,R]=(0,a.useState)(null),[S,I]=(0,a.useState)(!1),[z,q]=(0,a.useState)(!1),[M,B]=(0,a.useState)([]),[P,T]=(0,a.useState)(!1),[F,O]=(0,a.useState)(""),[V,U]=(0,a.useState)(""),[W,Z]=(0,a.useState)(!1),_=(0,a.useRef)(null),D=(0,a.useRef)(null),G=(0,a.useRef)(null),H=(0,a.useRef)(),J=(null===c||void 0===c?void 0:c.cinVerified)||(null===c||void 0===c?void 0:c.cin_verified),X=(null===c||void 0===c?void 0:c.cinPending)||(null===c||void 0===c?void 0:c.cin_verification_requested_at),[$,Q]=a.useState(!1);if(a.useEffect(()=>{"owner"!==(null===c||void 0===c?void 0:c.userType)||J||X||Q(!0)},[c,J,X]),"owner"===(null===c||void 0===c?void 0:c.userType)&&!J&&!X)return(0,j.jsx)(n.A,{isOpen:$,onClose:()=>Q(!1),backButtonText:"Retour au tableau de bord",onBackClick:()=>e("/dashboard")});if("owner"===(null===c||void 0===c?void 0:c.userType)&&!J&&X)return(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,j.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,j.jsx)(d.A,{className:"w-16 h-16 text-blue-500 mx-auto mb-4"}),(0,j.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"V\xe9rification en cours"}),(0,j.jsx)("p",{className:"text-gray-600 mb-4",children:"Votre CIN est en cours de validation. Vous pourrez publier un logement d\xe8s qu'elle sera approuv\xe9e."}),(0,j.jsx)("button",{onClick:()=>e("/dashboard"),className:"w-full btn-secondary",children:"Retour au tableau de bord"})]})});const Y=["Analakely","Ambohijatovo","Ankadifotsy","Ankatso","Antaninarenina","Behoririka","Isoraka","Mahamasina","Tsaralalana","67ha"],K=()=>{navigator.geolocation?(q(!0),g.Ay.loading("R\xe9cup\xe9ration de votre position actuelle..."),navigator.geolocation.getCurrentPosition(e=>{const{latitude:t,longitude:s}=e.coords;k({lat:t,lng:s}),R({lat:t,lng:s}),ee(t,s),g.Ay.dismiss(),g.Ay.success("Position d\xe9tect\xe9e : ".concat(t.toFixed(5),", ").concat(s.toFixed(5))),q(!1)},e=>{switch(g.Ay.dismiss(),q(!1),e.code){case e.PERMISSION_DENIED:g.Ay.error("Permission de g\xe9olocalisation refus\xe9e");break;case e.POSITION_UNAVAILABLE:g.Ay.error("Position GPS indisponible");break;case e.TIMEOUT:g.Ay.error("Timeout de la g\xe9olocalisation");break;default:g.Ay.error("Erreur de g\xe9olocalisation inconnue")}},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})):g.Ay.error("La g\xe9olocalisation n'est pas support\xe9e par votre navigateur")},ee=async(e,t)=>{try{const s=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(e,"&lon=").concat(t,"&zoom=18&addressdetails=1")),a=await s.json();if(a&&a.display_name){const e=a.display_name;if(f(t=>(0,r.A)((0,r.A)({},t),{},{address:e})),a.address){const e=a.address.suburb||a.address.neighbourhood||a.address.quarter;e&&Y.includes(e)&&f(t=>(0,r.A)((0,r.A)({},t),{},{district:e}))}}}catch(s){console.error("Erreur reverse geocoding:",s)}},te=async e=>{try{const t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e),"&limit=5&countrycodes=mg")),s=await t.json();if(s&&s.length>0){const e=s[0];return{lat:parseFloat(e.lat),lng:parseFloat(e.lon)}}return null}catch(t){return console.error("Erreur geocoding:",t),null}},se=e=>{if(!D.current||!A)return;const t=D.current.getBoundingClientRect(),s=(e.clientX-t.left)/t.width,r=(e.clientY-t.top)/t.height,a={lat:A.lat+.01*(r-.5),lng:A.lng+.01*(s-.5)};R(a)},re=e=>{const{name:t,value:s}=e.target;f(e=>(0,r.A)((0,r.A)({},e),{},{[t]:"price"===t||"deposit"===t||"availableRooms"===t||"totalRooms"===t?Number(s):s}))};return(0,j.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,j.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,j.jsxs)("div",{className:"mb-8",children:[(0,j.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Publier un logement"}),(0,j.jsx)("p",{className:"text-gray-600",children:"Partagez votre logement avec des \xe9tudiants \xe0 la recherche d'une colocation"})]}),(0,j.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),!c)return g.Ay.error("Vous devez \xeatre connect\xe9 pour cr\xe9er une propri\xe9t\xe9"),void e("/login");if(b.title.trim())if(b.description.trim())if(b.address.trim())if(b.district)if(b.price<=0)g.Ay.error("Le prix doit \xeatre sup\xe9rieur \xe0 0");else if("apartment"===b.propertyType&&(b.price<5e4||b.price>15e4))g.Ay.error("Le prix d'un appartement doit \xeatre entre 50 000 Ar et 150 000 Ar par mois");else if(b.deposit<0)g.Ay.error("La caution ne peut pas \xeatre n\xe9gative");else if(b.availableRooms>b.totalRooms)g.Ay.error("Le nombre de chambres disponibles ne peut pas \xeatre sup\xe9rieur au total");else if(b.availableRooms<=0)g.Ay.error("Il doit y avoir au moins une chambre disponible");else if(0!==y.length)if(A)try{g.Ay.loading("Upload des images en cours...");const s=await(async()=>{if(0===y.length)return[];I(!0);try{const e=y.map(e=>e.file),t=await N(e);return g.Ay.success("Toutes les images ont \xe9t\xe9 upload\xe9es avec succ\xe8s"),t}catch(e){throw g.Ay.error("Erreur lors de l'upload des images: ".concat(e.message)),e}finally{I(!1)}})();if(0===s.length)return void g.Ay.error("Aucune image n'a pu \xeatre upload\xe9e");g.Ay.dismiss(),console.log("Coordonn\xe9es avant envoi:",A),await t((0,r.A)((0,r.A)({},b),{},{images:s,latitude:A.lat,longitude:A.lng})),y.forEach(e=>URL.revokeObjectURL(e.preview)),e("/dashboard")}catch(a){console.error("Erreur lors de la cr\xe9ation:",a),g.Ay.dismiss(),g.Ay.error(a instanceof Error?a.message:"Une erreur est survenue lors de la cr\xe9ation de la propri\xe9t\xe9")}else g.Ay.error("Veuillez confirmer la localisation sur la carte");else g.Ay.error("Veuillez ajouter au moins une image");else g.Ay.error("Le quartier est requis");else g.Ay.error("L'adresse est requise");else g.Ay.error("La description est requise");else g.Ay.error("Le titre est requis")},className:"space-y-8",children:[(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Informations de base"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre de l'annonce *"}),(0,j.jsx)("input",{type:"text",name:"title",value:b.title,onChange:re,className:"input-field",placeholder:"Ex: Appartement 3 chambres \xe0 Analakely",required:!0})]}),(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,j.jsx)("textarea",{name:"description",value:b.description,onChange:re,rows:4,className:"input-field",placeholder:"D\xe9crivez votre logement, ses avantages, le quartier...",required:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de logement *"}),(0,j.jsx)("select",{name:"propertyType",value:b.propertyType,onChange:re,className:"input-field",required:!0,children:[{value:"apartment",label:"Appartement"},{value:"house",label:"Maison"},{value:"studio",label:"Studio"}].map(e=>(0,j.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quartier *"}),(0,j.jsxs)("select",{name:"district",value:b.district,onChange:re,className:"input-field",required:!0,children:[(0,j.jsx)("option",{value:"",children:"S\xe9lectionnez un quartier"}),Y.map(e=>(0,j.jsx)("option",{value:e,children:e},e))]})]})]})]}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Localisation"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse compl\xe8te *"}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsxs)("div",{className:"flex space-x-2",children:[(0,j.jsxs)("div",{className:"flex-1 relative",children:[(0,j.jsx)("input",{ref:G,type:"text",name:"address",value:b.address,onChange:e=>{const t=e.target.value;f(e=>(0,r.A)((0,r.A)({},e),{},{address:t})),H.current&&clearTimeout(H.current),H.current=setTimeout(()=>{(async e=>{if(e.length<3)return B([]),void T(!1);try{const t=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e),"&limit=5&countrycodes=mg")),s=await t.json();if(s&&s.length>0){const e=s.map(e=>e.display_name);B(e),T(!0)}else B([]),T(!1)}catch(t){console.error("Erreur recherche adresse:",t),B([]),T(!1)}})(t)},500)},className:"input-field pr-10",placeholder:"Ex: Rue de l'Ind\xe9pendance, Analakely, Antananarivo",required:!0,onFocus:()=>{M.length>0&&T(!0)},onBlur:()=>{setTimeout(()=>T(!1),200)}}),(0,j.jsx)(m.A,{className:"w-5 h-5 text-gray-400 absolute right-3 top-1/2 transform -translate-y-1/2"})]}),(0,j.jsxs)("button",{type:"button",onClick:K,className:"btn-secondary flex items-center space-x-2 whitespace-nowrap",disabled:z,title:"Utiliser ma position actuelle",children:[z?(0,j.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):(0,j.jsx)(v,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Ma position"})]}),(0,j.jsxs)("button",{type:"button",onClick:async()=>{if(b.address.trim())try{g.Ay.loading("Recherche des coordonn\xe9es...");const e=await te(b.address);e?(k(e),R(e),E(!0),g.Ay.dismiss(),g.Ay.success("Coordonn\xe9es trouv\xe9es ! Ajustez la position sur la carte.")):(g.Ay.dismiss(),g.Ay.error("Impossible de trouver les coordonn\xe9es pour cette adresse"))}catch(e){g.Ay.dismiss(),g.Ay.error("Erreur lors de la g\xe9olocalisation")}else g.Ay.error("Veuillez d'abord saisir une adresse")},className:"btn-secondary flex items-center space-x-2 whitespace-nowrap",disabled:!b.address.trim(),title:"Localiser cette adresse",children:[(0,j.jsx)(u.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Localiser"})]})]}),P&&M.length>0&&(0,j.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:M.map((e,t)=>(0,j.jsx)("button",{type:"button",className:"w-full px-4 py-2 text-left hover:bg-gray-100 border-b border-gray-100 last:border-b-0",onClick:()=>(async e=>{f(t=>(0,r.A)((0,r.A)({},t),{},{address:e})),T(!1),B([]),g.Ay.loading("R\xe9cup\xe9ration des coordonn\xe9es...");const t=await te(e);t?(k(t),R(t),g.Ay.dismiss(),g.Ay.success("Adresse localis\xe9e sur la carte !")):(g.Ay.dismiss(),g.Ay.error("Impossible de localiser cette adresse"))})(e),children:(0,j.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,j.jsx)(u.A,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),(0,j.jsx)("span",{className:"text-sm text-gray-700",children:e})]})},t))})]}),(0,j.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[(0,j.jsx)("p",{children:"Commencez \xe0 taper pour voir les suggestions d'adresse"}),(0,j.jsx)("p",{children:'Ou sur "Mobile" utilisez "Ma position" pour d\xe9tecter automatiquement votre localisation actuelle'})]})]}),(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Localisation sur la carte"}),(0,j.jsx)("div",{className:"mb-4",children:(0,j.jsxs)("button",{type:"button",onClick:()=>Z(!W),className:"btn-secondary flex items-center space-x-2 text-sm",children:[(0,j.jsx)(x.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Saisir les coordonn\xe9es manuellement"})]})}),W&&(0,j.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,j.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:"Saisie manuelle des coordonn\xe9es"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Latitude *"}),(0,j.jsx)("input",{type:"text",value:F,onChange:e=>O(e.target.value),className:"input-field text-sm",placeholder:"Ex: -18.8792"}),(0,j.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Entre -90 et 90"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-xs font-medium text-blue-700 mb-1",children:"Longitude *"}),(0,j.jsx)("input",{type:"text",value:V,onChange:e=>U(e.target.value),className:"input-field text-sm",placeholder:"Ex: 47.5079"}),(0,j.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Entre -180 et 180"})]})]}),(0,j.jsxs)("div",{className:"flex space-x-2 mt-3",children:[(0,j.jsx)("button",{type:"button",onClick:()=>{const e=parseFloat(F),t=parseFloat(V);if(isNaN(e)||isNaN(t))return void g.Ay.error("Veuillez saisir des coordonn\xe9es valides");if(e<-90||e>90)return void g.Ay.error("La latitude doit \xeatre entre -90 et 90");if(t<-180||t>180)return void g.Ay.error("La longitude doit \xeatre entre -180 et 180");const s={lat:e,lng:t};k(s),R(s),Z(!1),O(""),U(""),g.Ay.success("Coordonn\xe9es manuelles enregistr\xe9es !")},className:"btn-primary text-sm px-3 py-2",children:"Valider les coordonn\xe9es"}),(0,j.jsx)("button",{type:"button",onClick:()=>{Z(!1),O(""),U("")},className:"btn-secondary text-sm px-3 py-2",children:"Annuler"})]})]}),(0,j.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50",children:A?(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsxs)("div",{className:"w-full h-48 rounded-lg flex items-center justify-center relative overflow-hidden",children:[(0,j.jsx)("iframe",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{border:0},loading:"lazy",allowFullScreen:!0,title:"Carte de localisation du logement",src:"https://www.google.com/maps?q=".concat(A.lat,",").concat(A.lng,"&z=16&output=embed")}),(0,j.jsx)("div",{ref:D,className:"absolute inset-0 cursor-pointer",onClick:se,children:(0,j.jsxs)("div",{className:"absolute w-6 h-6 transform -translate-x-1/2 -translate-y-1/2",style:{left:"50%",top:"50%"},children:[(0,j.jsx)("div",{className:"w-6 h-6 bg-red-500 rounded-full border-2 border-white shadow-lg"}),(0,j.jsx)("div",{className:"w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]})})]}),(0,j.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,j.jsxs)("p",{children:["Latitude: ",A.lat.toFixed(6)]}),(0,j.jsxs)("p",{children:["Longitude: ",A.lng.toFixed(6)]})]}),(0,j.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,j.jsx)("button",{type:"button",onClick:()=>E(!0),className:"btn-secondary text-sm",children:"Ajuster sur la carte"}),(0,j.jsx)("button",{type:"button",onClick:()=>Z(!0),className:"btn-secondary text-sm",children:"Modifier manuellement"})]})]}):(0,j.jsxs)("div",{className:"text-center py-8",children:[(0,j.jsx)(u.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,j.jsx)("p",{className:"text-gray-500 mb-2",children:"Aucune localisation d\xe9finie"}),(0,j.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:'Saisissez une adresse, utilisez "Ma position" ou entrez les coordonn\xe9es manuellement'}),(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[(0,j.jsx)("button",{type:"button",onClick:K,className:"btn-primary flex items-center space-x-2 text-sm",disabled:z,children:z?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,j.jsx)("span",{children:"D\xe9tection..."})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Utiliser ma position"})]})}),(0,j.jsxs)("button",{type:"button",onClick:()=>Z(!0),className:"btn-secondary flex items-center space-x-2 text-sm",children:[(0,j.jsx)(x.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Saisir manuellement"})]})]})]})})]})]})]}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Tarification"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix mensuel (Ar) *"}),(0,j.jsx)("input",{type:"number",name:"price",value:b.price||"",onChange:re,className:"input-field",placeholder:"200000",min:"1",required:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caution (Ar) *"}),(0,j.jsx)("input",{type:"number",name:"deposit",value:b.deposit||"",onChange:re,className:"input-field",placeholder:"100000",min:"0",required:!0})]})]})]}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Chambres"}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre total de chambres *"}),(0,j.jsx)("input",{type:"number",name:"totalRooms",value:b.totalRooms,onChange:re,className:"input-field",min:"1",required:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chambres disponibles *"}),(0,j.jsx)("input",{type:"number",name:"availableRooms",value:b.availableRooms,onChange:re,className:"input-field",min:"1",max:b.totalRooms,required:!0})]})]})]}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"\xc9quipements"}),(0,j.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["Internet","Eau chaude","S\xe9curit\xe9","Parking","Jardin","Climatisation","Machine \xe0 laver","Cuisine \xe9quip\xe9e","Balcon","Ascenseur","Piscine","Gym"].map(e=>(0,j.jsxs)("label",{className:"flex items-center",children:[(0,j.jsx)("input",{type:"checkbox",checked:b.amenities.includes(e),onChange:()=>(e=>{f(t=>(0,r.A)((0,r.A)({},t),{},{amenities:t.amenities.includes(e)?t.amenities.filter(t=>t!==e):[...t.amenities,e]}))})(e),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,j.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))})]}),(0,j.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,j.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Photos"}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[(0,j.jsx)("input",{ref:_,type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=e.target.files;if(!t)return;const s=[];for(let r=0;r<t.length;r++){const e=t[r];if(!e.type.startsWith("image/")){g.Ay.error("".concat(e.name," n'est pas une image valide"));continue}if(e.size>5242880){g.Ay.error("".concat(e.name," est trop volumineux (max 5MB)"));continue}if(y.length+s.length>=10){g.Ay.error("Maximum 10 images autoris\xe9es");break}const a={file:e,preview:URL.createObjectURL(e),id:Math.random().toString(36).substr(2,9)};s.push(a)}s.length>0&&(w(e=>[...e,...s]),g.Ay.success("".concat(s.length," image(s) ajout\xe9e(s) avec succ\xe8s"))),_.current&&(_.current.value="")},className:"hidden"}),(0,j.jsxs)("div",{className:"flex-1 text-sm text-gray-500",children:[(0,j.jsx)("p",{children:"Formats accept\xe9s: JPG, PNG, WebP \u2022 Max 5MB par image \u2022 Maximum 10 images"}),(0,j.jsx)("p",{className:"text-green-600 font-medium",children:"Les images seront sauvegard\xe9es d\xe9finitivement"})]})]}),y.length>0&&(0,j.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,j.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:[y.length," image(s) s\xe9lectionn\xe9e(s) sur 10 maximum"]}),S&&(0,j.jsx)("div",{className:"flex items-center space-x-2",children:(0,j.jsx)("span",{className:"text-xs text-blue-600",children:"Upload en cours..."})})]}),y.length>0&&(0,j.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:y.map((e,t)=>(0,j.jsxs)("div",{className:"relative group bg-gray-100 rounded-lg overflow-hidden",children:[(0,j.jsx)("img",{src:e.preview,alt:"Aper\xe7u ".concat(t+1),className:"w-full h-32 object-cover transition-transform group-hover:scale-105"}),(0,j.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all flex items-center justify-center",children:(0,j.jsx)("button",{type:"button",onClick:()=>(e=>{URL.revokeObjectURL(y[e].preview),w(t=>t.filter((t,s)=>s!==e)),g.Ay.success("Image supprim\xe9e")})(t),className:"opacity-0 group-hover:opacity-100 bg-red-500 text-white rounded-full p-2 hover:bg-red-600 transition-all transform scale-90 group-hover:scale-100",title:"Supprimer l'image",disabled:S,children:(0,j.jsx)(h.A,{className:"w-4 h-4"})})}),(0,j.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-2",children:[(0,j.jsx)("p",{className:"text-xs text-white truncate",children:e.file.name}),(0,j.jsxs)("p",{className:"text-xs text-gray-300",children:[(e.file.size/1048576).toFixed(1)," MB"]})]}),(0,j.jsx)("div",{className:"absolute top-2 left-2 bg-black bg-opacity-60 text-white text-xs px-2 py-1 rounded-full",children:t+1})]},e.id))}),0===y.length&&(0,j.jsxs)("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50",children:[(0,j.jsx)(p.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,j.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune image s\xe9lectionn\xe9e"}),(0,j.jsx)("p",{className:"text-gray-500 mb-4",children:"Ajoutez des photos attractives de votre logement"}),(0,j.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},className:"btn-secondary flex items-center space-x-2 mx-auto",disabled:S,children:[(0,j.jsx)(x.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"S\xe9lectionner des images"})]})]})]})]}),(0,j.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,j.jsx)("button",{type:"button",onClick:()=>e("/dashboard"),className:"btn-secondary",disabled:s||S,children:"Annuler"}),(0,j.jsx)("button",{type:"submit",disabled:s||S||0===y.length,className:"btn-primary flex items-center space-x-2",children:s||S?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,j.jsx)("span",{children:S?"Upload...":"Publication..."})]}):"Publier le logement"})]})]}),C&&(0,j.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,j.jsx)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto",children:(0,j.jsxs)("div",{className:"p-6",children:[(0,j.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Ajuster la position sur la carte"}),(0,j.jsx)("div",{className:"mb-3",children:(0,j.jsxs)("button",{type:"button",onClick:()=>{L&&(O(L.lat.toString()),U(L.lng.toString())),Z(!0),E(!1)},className:"btn-secondary flex items-center space-x-2 text-sm",children:[(0,j.jsx)(x.A,{className:"w-4 h-4"}),(0,j.jsx)("span",{children:"Saisir les coordonn\xe9es manuellement"})]})}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Cliquez sur la carte pour positionner le marqueur"}),(0,j.jsx)("div",{className:"text-xs text-gray-500",children:L&&(0,j.jsxs)("p",{children:["Position actuelle: ",L.lat.toFixed(6),", ",L.lng.toFixed(6)]})})]}),(0,j.jsxs)("div",{ref:D,className:"w-full h-64 rounded-lg cursor-pointer relative mb-4 border-2 border-gray-300 overflow-hidden",onClick:se,children:[(0,j.jsx)("iframe",{className:"absolute inset-0 w-full h-full pointer-events-none",style:{border:0},loading:"lazy",allowFullScreen:!0,title:"Carte d'ajustement de la position",src:((e,t,s,r)=>{const a=null!==(e=null!==(t=null===L||void 0===L?void 0:L.lat)&&void 0!==t?t:null===A||void 0===A?void 0:A.lat)&&void 0!==e?e:0,l=null!==(s=null!==(r=null===L||void 0===L?void 0:L.lng)&&void 0!==r?r:null===A||void 0===A?void 0:A.lng)&&void 0!==s?s:0;return"https://www.google.com/maps?q=".concat(a,",").concat(l,"&z=16&output=embed")})()}),L&&(0,j.jsxs)("div",{className:"absolute w-6 h-6 transform -translate-x-1/2 -translate-y-1/2",style:{left:"50%",top:"50%"},children:[(0,j.jsx)("div",{className:"w-6 h-6 bg-red-500 rounded-full border-2 border-white shadow-lg"}),(0,j.jsx)("div",{className:"w-2 h-2 bg-white rounded-full absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]})]}),(0,j.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,j.jsx)("button",{type:"button",onClick:()=>E(!1),className:"btn-secondary",children:"Annuler"}),(0,j.jsx)("button",{type:"button",onClick:()=>{L&&(k(L),g.Ay.success("Emplacement confirm\xe9 !")),E(!1)},className:"btn-primary",disabled:!L,children:"Confirmer l'emplacement"})]})]})})})]})})}},7012:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const n=a.forwardRef(i)},7449:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const n=a.forwardRef(i)},7459:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const n=a.forwardRef(i)},7591:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const n=a.forwardRef(i)},8662:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(3986),a=s(5043);const l=["title","titleId"];function i(e,t){let{title:s,titleId:i}=e,n=(0,r.A)(e,l);return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),s?a.createElement("title",{id:i},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const n=a.forwardRef(i)}}]);
//# sourceMappingURL=717.f0818d70.chunk.js.map