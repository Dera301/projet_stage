"use strict";(self.webpackChunkcolocation_antananarivo=self.webpackChunkcolocation_antananarivo||[]).push([[707],{1602:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(3986),n=r(5043);const s=["title","titleId"];function l(e,t){let{title:r,titleId:l}=e,i=(0,a.A)(e,s);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},i),r?n.createElement("title",{id:l},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const i=n.forwardRef(l)},1707:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var a=r(5043),n=r(3216),s=r(5475),l=r(9741),i=r(4439),o=r(9349),c=r(2339),d=r(7012),u=r(9399),m=r(2556),x=r(1602),h=r(7591),p=r(579);const b=async e=>{try{var t,r;const a=new FormData;a.append("image",e);const n=await(0,o.yX)("/api/upload/image",a);if(!n.success)throw new Error(n.message||"Erreur lors de l'upload");return(null===(t=n.data)||void 0===t?void 0:t.url)||(null===(r=n.data)||void 0===r?void 0:r.path)||""}catch(a){throw console.error("Erreur upload:",a),new Error(a.message||"Erreur lors de l'upload")}},v=()=>{const{user:e}=(0,l.A)(),t=(0,n.Zp)(),{createAnnouncement:r}=(0,i.b)(),[o,v]=(0,a.useState)(""),[f,g]=(0,a.useState)(""),[j,w]=(0,a.useState)([]),[y,N]=(0,a.useState)(!1),k=(0,a.useRef)(null);if(!e)return(0,p.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,p.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})});if("student"!==e.userType)return(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,p.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,p.jsx)(u.A,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),(0,p.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"R\xe9serv\xe9 aux \xe9tudiants"}),(0,p.jsx)("p",{className:"text-gray-600 mb-4",children:"Seuls les comptes \xe9tudiants peuvent publier une annonce de colocation."}),(0,p.jsx)("button",{onClick:()=>t("/dashboard"),className:"w-full btn-secondary",children:"Retour"})]})});const A=(null===e||void 0===e?void 0:e.cinVerified)||(null===e||void 0===e?void 0:e.cin_verified),E=(null===e||void 0===e?void 0:e.cinPending)||(null===e||void 0===e?void 0:e.cin_verification_requested_at);if(!A&&!E)return(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,p.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,p.jsx)(u.A,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),(0,p.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"V\xe9rification Requise"}),(0,p.jsx)("p",{className:"text-gray-600 mb-4",children:"Vous devez v\xe9rifier votre CIN avant de pouvoir publier des annonces."}),(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsxs)(s.N_,{to:"/cin-verification",className:"w-full btn-primary flex items-center justify-center space-x-2",children:[(0,p.jsx)(m.A,{className:"w-5 h-5"}),(0,p.jsx)("span",{children:"V\xe9rifier mon CIN"})]}),(0,p.jsx)("button",{onClick:()=>t("/dashboard"),className:"w-full btn-secondary",children:"Retour au tableau de bord"})]})]})});if(!A&&E)return(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,p.jsxs)("div",{className:"max-w-md w-full text-center",children:[(0,p.jsx)(d.A,{className:"w-16 h-16 text-blue-500 mx-auto mb-4"}),(0,p.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"V\xe9rification en cours"}),(0,p.jsx)("p",{className:"text-gray-600 mb-4",children:"Votre CIN est en cours de validation. Vous pourrez publier une annonce d\xe8s qu'elle sera approuv\xe9e."}),(0,p.jsx)("button",{onClick:()=>t("/dashboard"),className:"w-full btn-secondary",children:"Retour au tableau de bord"})]})});return(0,p.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,p.jsxs)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,p.jsxs)("div",{className:"mb-8",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Publier une annonce de colocation"}),(0,p.jsx)("p",{className:"text-gray-600",children:"Partagez ce que vous recherchez (quartier, budget, pr\xe9f\xe9rences) et ajoutez des images si besoin."})]}),(0,p.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o.trim())try{c.Ay.loading("Publication en cours...");const e=await(async()=>{if(0===j.length)return[];N(!0);try{const e=j.map(e=>e.file);return await Promise.all(e.map(b))}finally{N(!1)}})();c.Ay.dismiss();const a={content:o.trim(),images:e,contact:f.trim()||void 0};await r(a),j.forEach(e=>URL.revokeObjectURL(e.preview)),t("/announcements")}catch(a){c.Ay.dismiss(),c.Ay.error(a.message||"Erreur lors de la publication")}else c.Ay.error("Le texte de votre annonce est requis")},className:"space-y-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Texte de l'annonce *"}),(0,p.jsx)("textarea",{value:o,onChange:e=>v(e.target.value),rows:5,className:"input-field",placeholder:"Ex: \xc9tudiant en info, je cherche une colocation \xe0 Isoraka, budget 300 000 Ar, non fumeur...",required:!0})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact (optionnel)"}),(0,p.jsx)("input",{value:f,onChange:e=>g(e.target.value),type:"text",className:"input-field",placeholder:"T\xe9l\xe9phone, email, etc."})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images (max 6)"}),(0,p.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,p.jsx)("input",{ref:k,type:"file",accept:"image/*",multiple:!0,onChange:e=>{const t=e.target.files;if(!t)return;const r=[];for(let a=0;a<t.length;a++){const e=t[a];if(e.type.startsWith("image/"))if(e.size>5242880)c.Ay.error("".concat(e.name," est trop volumineux (max 5MB)"));else{if(j.length+r.length>=6){c.Ay.error("Maximum 6 images");break}r.push({file:e,preview:URL.createObjectURL(e),id:Math.random().toString(36).slice(2)})}else c.Ay.error("".concat(e.name," n'est pas une image valide"))}r.length>0&&(w(e=>[...e,...r]),c.Ay.success("".concat(r.length," image(s) ajout\xe9e(s)"))),k.current&&(k.current.value="")},className:"hidden",id:"announcementImages"}),(0,p.jsxs)("label",{htmlFor:"announcementImages",className:"cursor-pointer inline-flex items-center space-x-2 btn-secondary",children:[(0,p.jsx)(x.A,{className:"w-5 h-5"}),(0,p.jsx)("span",{children:"Ajouter des images"})]}),j.length>0&&(0,p.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 mt-4",children:j.map((e,t)=>(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("img",{src:e.preview,alt:"preview",className:"w-full h-32 object-cover rounded-lg"}),(0,p.jsx)("button",{type:"button",onClick:()=>{return e=t,URL.revokeObjectURL(j[e].preview),void w(t=>t.filter((t,r)=>r!==e));var e},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,p.jsx)(h.A,{className:"w-4 h-4"})})]},e.id))})]})]}),(0,p.jsxs)("div",{className:"flex space-x-3",children:[(0,p.jsx)("button",{type:"button",onClick:()=>t("/announcements"),className:"btn-secondary",children:"Annuler"}),(0,p.jsx)("button",{type:"submit",disabled:y||!o.trim(),className:"btn-primary",children:"Publier"})]})]})]})})}},2556:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(3986),n=r(5043);const s=["title","titleId"];function l(e,t){let{title:r,titleId:l}=e,i=(0,a.A)(e,s);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},i),r?n.createElement("title",{id:l},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z"}))}const i=n.forwardRef(l)},7012:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(3986),n=r(5043);const s=["title","titleId"];function l(e,t){let{title:r,titleId:l}=e,i=(0,a.A)(e,s);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},i),r?n.createElement("title",{id:l},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const i=n.forwardRef(l)},7591:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(3986),n=r(5043);const s=["title","titleId"];function l(e,t){let{title:r,titleId:l}=e,i=(0,a.A)(e,s);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},i),r?n.createElement("title",{id:l},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const i=n.forwardRef(l)},9399:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(3986),n=r(5043);const s=["title","titleId"];function l(e,t){let{title:r,titleId:l}=e,i=(0,a.A)(e,s);return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":l},i),r?n.createElement("title",{id:l},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const i=n.forwardRef(l)}}]);
//# sourceMappingURL=707.b9df41ed.chunk.js.map