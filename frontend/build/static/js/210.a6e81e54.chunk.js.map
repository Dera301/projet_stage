{"version":3,"file":"static/js/210.a6e81e54.chunk.js","mappings":"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","sources":["pages/VerifyAccountPage.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { Link, useLocation, useNavigate, useSearchParams } from 'react-router-dom';\r\nimport toast from 'react-hot-toast';\r\nimport { useAuth } from '../contexts/AuthContext';\r\n\r\nconst logoSrc = `${process.env.PUBLIC_URL}/logo_colo.svg`;\r\n\r\nconst VerifyAccountPage: React.FC = () => {\r\n  const { verifyEmail, resendVerificationCode } = useAuth();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [searchParams] = useSearchParams();\r\n\r\n  const locationState = useMemo(() => {\r\n    return (location.state as { pendingId?: string; email?: string } | null) || {};\r\n  }, [location.state]);\r\n\r\n  const initialPendingId = locationState.pendingId || searchParams.get('pendingId') || '';\r\n  const initialEmail = locationState.email || searchParams.get('email') || '';\r\n\r\n  const [pendingId, setPendingId] = useState(initialPendingId);\r\n  const [email, setEmail] = useState(initialEmail);\r\n  const [verificationCode, setVerificationCode] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isResending, setIsResending] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setPendingId(initialPendingId);\r\n    setEmail(initialEmail);\r\n  }, [initialPendingId, initialEmail]);\r\n\r\n  useEffect(() => {\r\n    if (!initialPendingId || !initialEmail) {\r\n      toast(\r\n        'Veuillez v√©rifier votre bo√Æte mail et suivre le lien re√ßu pour valider votre compte.',\r\n        { icon: 'üì©' }\r\n      );\r\n    }\r\n  }, [initialPendingId, initialEmail]);\r\n\r\n  const handleSubmit = async (event: React.FormEvent) => {\r\n    event.preventDefault();\r\n    if (!pendingId) {\r\n      toast.error('Identifiant de v√©rification manquant. Merci de recommencer votre inscription.');\r\n      return;\r\n    }\r\n    if (!verificationCode) {\r\n      toast.error('Veuillez saisir le code de v√©rification.');\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    try {\r\n      const result = await verifyEmail(pendingId, verificationCode);\r\n      if (result.success) {\r\n        toast.success('Compte v√©rifi√© avec succ√®s ! Vous pouvez maintenant vous connecter.');\r\n        navigate('/login');\r\n      } else {\r\n        toast.error(result.message || '√âchec de la v√©rification du compte.');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Erreur lors de la v√©rification du compte:', error);\r\n      toast.error(error.message || 'Code de v√©rification invalide ou expir√©');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleResend = async () => {\r\n    if (!email) {\r\n      toast.error('Veuillez indiquer une adresse email valide.');\r\n      return;\r\n    }\r\n\r\n    setIsResending(true);\r\n    try {\r\n      const result = await resendVerificationCode({ email, registrationId: pendingId || undefined });\r\n      if (!result.success) {\r\n        toast.error(result.message || 'Impossible d\\'envoyer un nouveau code');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Erreur lors du renvoi du code:', error);\r\n      toast.error(error.message || 'Impossible d\\'envoyer un nouveau code');\r\n    } finally {\r\n      setIsResending(false);\r\n    }\r\n  };\r\n\r\n  if (!pendingId) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12\">\r\n        <div className=\"max-w-lg w-full space-y-6 bg-white shadow-xl rounded-xl p-8 text-center\">\r\n          <img src={logoSrc} alt=\"ColocAntananarivo\" className=\"h-12 mx-auto\" />\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">V√©rification requise</h1>\r\n          <p className=\"text-gray-600\">\r\n            Nous ne trouvons pas d'inscription en attente. Cliquez sur le bouton ci-dessous pour recommencer la cr√©ation de votre compte.\r\n          </p>\r\n          <Link\r\n            to=\"/register\"\r\n            className=\"inline-flex justify-center rounded-md border border-transparent bg-primary-600 px-6 py-2 text-base font-medium text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\r\n          >\r\n            Cr√©er un compte\r\n          </Link>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\r\n      <div className=\"max-w-md w-full space-y-8\">\r\n        <div>\r\n          <div className=\"flex justify-center\">\r\n            <img src={logoSrc} alt=\"ColocAntananarivo\" className=\"h-12 w-auto\" />\r\n          </div>\r\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\r\n            Confirmez votre adresse email\r\n          </h2>\r\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\r\n            Entrez le code de 6 chiffres re√ßu √† <span className=\"font-medium\">{email || 'votre email'}</span>.\r\n          </p>\r\n        </div>\r\n\r\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label htmlFor=\"pendingId\" className=\"block text-sm font-medium text-gray-700\">\r\n                Identifiant d'inscription\r\n              </label>\r\n              <input\r\n                id=\"pendingId\"\r\n                name=\"pendingId\"\r\n                type=\"text\"\r\n                value={pendingId}\r\n                onChange={(e) => setPendingId(e.target.value)}\r\n                className=\"input-field mt-1\"\r\n                readOnly={!locationState.pendingId}\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Conservez cet identifiant pour toute assistance. Il est inclus dans le lien re√ßu par email.\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\r\n                Adresse email\r\n              </label>\r\n              <input\r\n                id=\"email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                className=\"input-field mt-1\"\r\n                placeholder=\"votre@email.com\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"verificationCode\" className=\"block text-sm font-medium text-gray-700\">\r\n                Code de v√©rification\r\n              </label>\r\n              <input\r\n                id=\"verificationCode\"\r\n                name=\"verificationCode\"\r\n                type=\"text\"\r\n                value={verificationCode}\r\n                onChange={(e) => setVerificationCode(e.target.value)}\r\n                className=\"input-field mt-1 text-center tracking-widest text-lg\"\r\n                placeholder=\"123456\"\r\n                maxLength={6}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Pas re√ßu de code ?</span>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleResend}\r\n                disabled={isResending}\r\n                className=\"font-medium text-primary-600 hover:text-primary-500 disabled:opacity-50\"\r\n              >\r\n                {isResending ? 'Envoi...' : 'Renvoyer le code'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isSubmitting}\r\n              className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {isSubmitting ? 'V√©rification...' : 'Activer mon compte'}\r\n            </button>\r\n\r\n            <p className=\"text-center text-sm text-gray-600\">\r\n              Vous avez d√©j√† valid√© votre adresse ?{' '}\r\n              <Link to=\"/login\" className=\"font-medium text-primary-600 hover:text-primary-500\">\r\n                Connectez-vous\r\n              </Link>\r\n            </p>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VerifyAccountPage;\r\n\r\n"],"names":["logoSrc","concat","process","VerifyAccountPage","verifyEmail","resendVerificationCode","useAuth","navigate","useNavigate","location","useLocation","searchParams","useSearchParams","locationState","useMemo","state","initialPendingId","pendingId","get","initialEmail","email","setPendingId","useState","setEmail","verificationCode","setVerificationCode","isSubmitting","setIsSubmitting","isResending","setIsResending","useEffect","toast","icon","_jsx","className","children","_jsxs","src","alt","onSubmit","async","event","preventDefault","result","success","error","message","console","htmlFor","id","name","type","value","onChange","e","target","readOnly","placeholder","maxLength","required","onClick","registrationId","undefined","disabled","Link","to"],"sourceRoot":""}